---
分类: [嵌入式]
标签: [KiCAD, 扩展板]
知识共享许可协议: CC-BY-SA 4.0
备注: 本文首发于CSDN，原文：https://blog.csdn.net/qq_44884716/article/details/109853114
时间: 2020-11-20 16:24:28
---

_使用过 Arduino 的朋友或多或少应该都见过 Arduino 那种直插的扩展板，不用排线不用焊接，只需排针排母上下对齐然后轻轻一推，就完成了模块化和集成化的完美结合。本文从自己制作的一个板子出发，基于 KiCAD 简单介绍一下扩展板的画法。_
@[TOC](目录)

## 设计思路

首先需要确定自己是要制作什么扩展板，这里我是为了自己的项目设计了一个 stm32f103c8 的板子，功能就是做成一个最小系统板，所有的接口都单独引出。

## 第一步：画好内部电路

在[Ultra](https://www.ultralibrarian.com/)找到需要的芯片的符号并下载，在导入后画出板子的内部电路。内部电路很简单，画出复位电路、供电电路、晶振时钟电路、冲击电流保护、开关显示电路。同时将 BOOT1 拉低，因为这块板子我不需要使用内置 SRAM 启动。

画好成果如下：

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/a92be0b5ec033941b724f24bc6d62234.png#pic_center)

## 第二步：画直插引脚符号

因为要做成扩展板，那么很多时候直插引脚的结构往往就是相同的，如果每次使用的时候都要重新画一次直插引脚，那么很显然这会是很复杂麻烦的一件事，所以直接将其做成一个直插引脚符号会很省时省力。在我的设计里面，这个板子是一个六边形，然后每条边上有八个引脚，同时这八个引脚里面前两个始终为 GND 和 3V3，然后我画了如下的这样的符号，为了省时省力，在自认为不会犯错的情况下，我对每个引脚的设置都为 Passive。

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/dba682d8053996fc90374886226162a2.png#pic_center)

## 第三步：将直插引脚符号导入并连接

画好符号后，就只需要将所需引脚连接起来即可，而后如果遇到其它的扩展板，也只需要将对应的引脚相互连接即可，这里我下拉了 BOOT0，如果需要让它上拉，只需要在外部电路连接 3V3 即可。

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/f83d4560f9e0be9449355ec0a73264dd.png#pic_center)

## 第四步：画直插引脚封装

和符号同理，这样设计之后就不需要每次都重新打孔，而且还要费心费力地去计算孔的位置，太麻烦，所以直接设计成封装。新建库、封装，通过计算找出所有孔的位置，然后挨个放孔、画边，最终结果如下，记住边框一定要用 Fab 层，这在后面的设计中很重要：

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/babba4e346f479e516680958fe224673.png#pic_center)

## 第五步：修改路径

为了使用这个扩展板的时候所有工程都可以用这个库，可以把库文件夹放在当前工程的上一级路径，然后点击首选项-管理封装库，找到刚才新建的库，对其路径进行修改为`$(KIPRJMOD)/../库文件夹名`，例如我的路径即为：

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/895e0091817832dd537dd368d78f1c8d.png#pic_center)

这里的/\.\.可以理解为打开上一级目录，而`$(KIPRJMOD)`则表示当前工程路径，这样只要每次新建工程都放在和库同级路径下，即可保证该库的使用了。

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/a62aef866dbe3905a25f8274030f4beb.png#pic_center)

## 第六步：分配封装

回到原理图界面，在标注完成且电器规则检查无误后即可分配封装了。

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/24cbc87936a9598681caec733809f6c9.png#pic_center)

## 第七步：画 PCB

分配完封装就可以直接开始连线了，不过注意的是需要现在电路板设置界面关闭要求封装中定义外框，这里的外框其实指的是 Crt 层，这样的话我们使用 Fab 层作为外框就可以在不干扰 PCB 电气特性的情况下同时不受禁止外框重叠的管束，那么其它元件就可以放在我们的直插引脚封装里面了！剩下的就是排布和拉线即可。

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/7a28511938582f9e2418211a4b887209.png#pic_center)

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/f52f168bcd78db04df8a3c485f60167c.png#pic_center)

## 第八步：导出生产文件并打板

注意控制我们的 PCB 在 10cm\*10cm 之间，这样我们就可以使用嘉立创的 5 元打样优惠了。导出生产文件然后打样的过程网上有很多，我在这里就不详述了。
